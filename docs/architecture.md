# ç³»ç»Ÿæ¶æ„è®¾è®¡

æœ¬æ–‡æ¡£ä»‹ç»ModuleWebUIçš„ç³»ç»Ÿæ¶æ„ã€è®¾è®¡ç†å¿µå’ŒæŠ€æœ¯é€‰å‹ã€‚

## ğŸ—ï¸ æ•´ä½“æ¶æ„

### æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·ç•Œé¢å±‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   é¡µé¢æ¨¡å— A   â”‚  é¡µé¢æ¨¡å— B   â”‚   é¡µé¢æ¨¡å— C   â”‚   é¡µé¢æ¨¡å— D    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      åº”ç”¨æ ¸å¿ƒå±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Router  â”‚  â”‚   UI    â”‚  â”‚  I18n   â”‚  â”‚ Overlay â”‚         â”‚
â”‚  â”‚ è·¯ç”±ç®¡ç† â”‚  â”‚ UIç®¡ç†   â”‚  â”‚ å›½é™…åŒ–  â”‚   â”‚ è¦†ç›–å±‚   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      åŸºç¡€è®¾æ–½å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ç¼“å­˜ç³»ç»Ÿ â”‚  â”‚ äº‹ä»¶ç³»ç»Ÿ â”‚   â”‚ æ¨¡å—åŠ è½½ â”‚  â”‚ æ€§èƒ½ä¼˜åŒ– â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      æ„å»ºå·¥å…·å±‚                               â”‚
â”‚                Vite + ä»£ç åˆ†å‰² + èµ„æºä¼˜åŒ–                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. App (åº”ç”¨ä¸»ç±»)
- **èŒè´£**: åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€ä¸»é¢˜æ§åˆ¶ã€åˆå§‹åŒ–åè°ƒ
- **ç‰¹ç‚¹**: å•ä¾‹æ¨¡å¼ï¼Œå…¨å±€çŠ¶æ€ç®¡ç†
- **å…³é”®æ–¹æ³•**: `init()`, `setTheme()`, `finishLoading()`

#### 2. Router (è·¯ç”±ç®¡ç†å™¨)
- **èŒè´£**: é¡µé¢å¯¼èˆªã€æ¨¡å—åŠ è½½ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **ç‰¹ç‚¹**: æ™ºèƒ½ç¼“å­˜ã€æ‡’åŠ è½½ã€é”™è¯¯å¤„ç†
- **å…³é”®æ–¹æ³•**: `navigate()`, `loadModule()`, `renderPage()`

#### 3. UI (ç•Œé¢ç®¡ç†å™¨)
- **èŒè´£**: ç•Œé¢å…ƒç´ æ§åˆ¶ã€å“åº”å¼å¸ƒå±€ã€ç”¨æˆ·äº¤äº’
- **ç‰¹ç‚¹**: è‡ªé€‚åº”å¸ƒå±€ã€åŠ¨æ€æŒ‰é’®ç®¡ç†
- **å…³é”®æ–¹æ³•**: `registerPageActions()`, `updateNav()`, `showLanguageSelector()`

#### 4. I18n (å›½é™…åŒ–ç³»ç»Ÿ)
- **èŒè´£**: å¤šè¯­è¨€æ”¯æŒã€åŠ¨æ€ç¿»è¯‘ã€è¯­è¨€åˆ‡æ¢
- **ç‰¹ç‚¹**: è¿è¡Œæ—¶åˆ‡æ¢ã€è‡ªåŠ¨åº”ç”¨ã€æ‰©å±•æ€§å¼º
- **å…³é”®æ–¹æ³•**: `translate()`, `setLanguage()`, `applyTranslations()`

## ğŸ”§ è®¾è®¡ç†å¿µ

### 1. æ¨¡å—åŒ–è®¾è®¡

**é¡µé¢å³æ¨¡å—**: æ¯ä¸ªé¡µé¢éƒ½æ˜¯ç‹¬ç«‹çš„æ¨¡å—ï¼Œå…·æœ‰å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸã€‚

```javascript
// æ ‡å‡†é¡µé¢æ¨¡å—ç»“æ„
export const PageModule = {
    // é…ç½®ä¿¡æ¯
    config: null,
    
    // ç”Ÿå‘½å‘¨æœŸé’©å­
    async init(ui) { /* åˆå§‹åŒ– */ },
    render() { /* æ¸²æŸ“ */ },
    async afterRender() { /* æ¸²æŸ“å */ },
    async onActivate() { /* æ¿€æ´» */ },
    async onDeactivate() { /* åœç”¨ */ },
    
    // é¢„åŠ è½½æ”¯æŒ
    async preload() { /* é¢„åŠ è½½ */ },
    async getHTML() { /* è·å–HTML */ }
};
```

**ä¼˜åŠ¿**:
- ğŸ”„ **çƒ­æ’æ‹”**: æ¨¡å—å¯ä»¥ç‹¬ç«‹å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²
- ğŸ¯ **èŒè´£æ¸…æ™°**: æ¯ä¸ªæ¨¡å—åªå…³æ³¨è‡ªå·±çš„åŠŸèƒ½
- ğŸš€ **æŒ‰éœ€åŠ è½½**: åªåŠ è½½å½“å‰éœ€è¦çš„æ¨¡å—
- ğŸ”§ **æ˜“äºç»´æŠ¤**: æ¨¡å—é—´è§£è€¦ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•

### 2. é…ç½®é©±åŠ¨

**é›†ä¸­é…ç½®ç®¡ç†**: æ‰€æœ‰é¡µé¢æ¨¡å—çš„åŸºç¡€ä¿¡æ¯éƒ½åœ¨ `main.js` ä¸­é›†ä¸­ç®¡ç†ã€‚

```javascript
const PAGE_MODULE_CONFIGS = {
    status: {
        id: 'status',
        name: 'çŠ¶æ€',
        icon: 'dashboard',
        module: 'StatusPage',
        i18n_key: 'NAV_STATUS',
        order: 1
    }
    // ... å…¶ä»–é…ç½®
};
```

**ä¼˜åŠ¿**:
- ğŸ“‹ **ç»Ÿä¸€ç®¡ç†**: æ‰€æœ‰é…ç½®ä¿¡æ¯é›†ä¸­ç®¡ç†
- ğŸ”„ **åŠ¨æ€æ‰©å±•**: æ”¯æŒè¿è¡Œæ—¶æ·»åŠ /ç§»é™¤æ¨¡å—
- ğŸ¨ **çµæ´»é…ç½®**: å›¾æ ‡ã€é¡ºåºã€åç§°ç­‰éƒ½å¯é…ç½®
- ğŸŒ **å›½é™…åŒ–å‹å¥½**: å†…ç½®å¤šè¯­è¨€æ”¯æŒ

### 3. äº‹ä»¶é©±åŠ¨

**æ¾è€¦åˆé€šä¿¡**: æ¨¡å—é—´é€šè¿‡äº‹ä»¶ç³»ç»Ÿè¿›è¡Œé€šä¿¡ã€‚

```javascript
// å‘é€äº‹ä»¶
const event = new CustomEvent('dataUpdated', {
    detail: { data: newData }
});
document.dispatchEvent(event);

// ç›‘å¬äº‹ä»¶
document.addEventListener('dataUpdated', (event) => {
    this.handleDataUpdate(event.detail.data);
});
```

**ç³»ç»Ÿäº‹ä»¶**:
- `languageChanged`: è¯­è¨€åˆ‡æ¢
- `translationsLoaded`: ç¿»è¯‘åŠ è½½å®Œæˆ
- `resize`: çª—å£å¤§å°å˜åŒ–

### 4. æ€§èƒ½ä¼˜å…ˆ

**å¤šå±‚ç¼“å­˜ç­–ç•¥**:

```javascript
// 1. æ¨¡å—ç¼“å­˜ - é¿å…é‡å¤åŠ è½½
window.app.router.cache

// 2. å†…å®¹ç¼“å­˜ - ç¼“å­˜æ¸²æŸ“ç»“æœ
window.app.cache

// 3. é¢„åŠ è½½ç¼“å­˜ - åå°é¢„åŠ è½½
window.app.preloadCache

// 4. æœ¬åœ°å­˜å‚¨ç¼“å­˜ - æŒä¹…åŒ–æ•°æ®
localStorage
```

**ä»£ç åˆ†å‰²**: ä½¿ç”¨Viteçš„åŠ¨æ€å¯¼å…¥å®ç°æŒ‰éœ€åŠ è½½ã€‚

```javascript
// åŠ¨æ€å¯¼å…¥é¡µé¢æ¨¡å—
const module = await import(`@pages/${name}.js`);
```

## ğŸ”„ æ•°æ®æµ

### é¡µé¢å¯¼èˆªæµç¨‹

```mermaid
sequenceDiagram
    participant User
    participant Router
    participant Module
    participant UI
    
    User->>Router: navigate(pageName)
    Router->>Router: deactivateCurrent()
    Router->>Router: loadModule(pageName)
    Router->>Module: init() [é¦–æ¬¡]
    Router->>Module: render()
    Router->>UI: renderPage()
    Router->>Module: afterRender()
    Router->>Module: onActivate()
    Router->>UI: updateNav()
```

### æ¨¡å—ç”Ÿå‘½å‘¨æœŸ

```mermaid
stateDiagram-v2
    [*] --> Loading: åŠ¨æ€å¯¼å…¥
    Loading --> Initializing: æ¨¡å—åŠ è½½å®Œæˆ
    Initializing --> Initialized: init()æˆåŠŸ
    Initialized --> Rendering: navigate()è°ƒç”¨
    Rendering --> Rendered: render()å®Œæˆ
    Rendered --> Active: onActivate()
    Active --> Inactive: åˆ‡æ¢é¡µé¢
    Inactive --> Active: é‡æ–°æ¿€æ´»
    Inactive --> [*]: æ¨¡å—å¸è½½
```

## ğŸ¨ UIæ¶æ„

### å“åº”å¼è®¾è®¡

**æ–­ç‚¹ç­–ç•¥**:
- **ç§»åŠ¨ç«¯**: < 768px
- **æ¡Œé¢ç«¯**: â‰¥ 768px

**è‡ªé€‚åº”å¸ƒå±€**:
```javascript
// æ ¹æ®å±å¹•å°ºå¯¸è°ƒæ•´å¸ƒå±€
const isLandscape = window.innerWidth >= 768;

if (isLandscape) {
    // æ¡Œé¢ç«¯ï¼šä¾§è¾¹æ æ˜¾ç¤ºæ“ä½œæŒ‰é’®
    this.renderActions(sidebarContainer, actions);
} else {
    // ç§»åŠ¨ç«¯ï¼šé¡¶éƒ¨æ˜¾ç¤ºæ“ä½œæŒ‰é’®
    this.renderActions(headerContainer, actions);
}
```

### ä¸»é¢˜ç³»ç»Ÿ

**CSSå˜é‡é©±åŠ¨**:
```css
:root {
    --primary: #1976d2;
    --background: #ffffff;
    --surface: #f5f5f5;
    --text: #333333;
}

[data-theme="dark"] {
    --primary: #90caf9;
    --background: #121212;
    --surface: #1e1e1e;
    --text: #ffffff;
}
```

**åŠ¨æ€åˆ‡æ¢**:
```javascript
setTheme(theme) {
    document.documentElement.setAttribute('data-theme', theme);
    localStorage.setItem('theme', theme);
    this.updateThemeIcons();
}
```

## ğŸŒ å›½é™…åŒ–æ¶æ„

### ç¿»è¯‘æ–‡ä»¶ç»“æ„

```
src/assets/translations/
â”œâ”€â”€ zh.json          # ä¸­æ–‡
â”œâ”€â”€ en.json          # è‹±æ–‡
â””â”€â”€ ru.json          # ä¿„æ–‡
```

### ç¿»è¯‘åº”ç”¨æœºåˆ¶

**HTMLè‡ªåŠ¨ç¿»è¯‘**:
```html
<h1 data-i18n="TITLE_KEY">é»˜è®¤æ ‡é¢˜</h1>
<input data-i18n-placeholder="SEARCH_PLACEHOLDER" placeholder="æœç´¢...">
```

**JavaScriptåŠ¨æ€ç¿»è¯‘**:
```javascript
const text = I18n.translate('KEY', 'é»˜è®¤æ–‡æœ¬');
```

### è¯­è¨€åˆ‡æ¢æµç¨‹

1. ç”¨æˆ·é€‰æ‹©è¯­è¨€
2. åŠ è½½å¯¹åº”ç¿»è¯‘æ–‡ä»¶
3. æ›´æ–° `I18n.currentLang`
4. è§¦å‘ `languageChanged` äº‹ä»¶
5. è‡ªåŠ¨åº”ç”¨ç¿»è¯‘åˆ°é¡µé¢
6. æ›´æ–°å¯¼èˆªæ ‡ç­¾å’Œé¡µé¢æ ‡é¢˜

## ğŸš€ æ„å»ºæ¶æ„

### Viteé…ç½®ç‰¹æ€§

```javascript
// vite.config.js å…³é”®é…ç½®
export default defineConfig({
    // è·¯å¾„åˆ«å
    resolve: {
        alias: {
            '@': path.resolve(__dirname, 'src'),
            '@assets': path.resolve(__dirname, 'src/assets'),
            '@components': path.resolve(__dirname, 'src/components'),
            '@pages': path.resolve(__dirname, 'src/pages')
        }
    },
    
    // æ„å»ºä¼˜åŒ–
    build: {
        rollupOptions: {
            output: {
                manualChunks: {
                    vendor: ['@components/modal.js'],
                    i18n: ['./src/i18n.js']
                }
            }
        }
    }
});
```

### ä»£ç åˆ†å‰²ç­–ç•¥

1. **é¡µé¢çº§åˆ†å‰²**: æ¯ä¸ªé¡µé¢æ¨¡å—ç‹¬ç«‹æ‰“åŒ…
2. **ç»„ä»¶çº§åˆ†å‰²**: å¤§å‹ç»„ä»¶æŒ‰éœ€åŠ è½½
3. **å·¥å…·åº“åˆ†å‰²**: ç¬¬ä¸‰æ–¹åº“å•ç‹¬æ‰“åŒ…
4. **èµ„æºåˆ†å‰²**: CSSã€å›¾ç‰‡ç­‰é™æ€èµ„æºä¼˜åŒ–

## ğŸ”§ æ‰©å±•æ€§è®¾è®¡

### æ·»åŠ æ–°é¡µé¢æ¨¡å—

1. **åˆ›å»ºæ¨¡å—æ–‡ä»¶**: `src/pages/newpage.js`
2. **æ³¨å†Œé…ç½®**: åœ¨ `main.js` ä¸­æ·»åŠ é…ç½®
3. **æ·»åŠ æ ·å¼**: `src/assets/css/pages/newpage.css`
4. **æ·»åŠ ç¿»è¯‘**: åœ¨ç¿»è¯‘æ–‡ä»¶ä¸­æ·»åŠ å¯¹åº”é”®å€¼

### è‡ªå®šä¹‰ç»„ä»¶

```javascript
// src/components/my-component.js
export class MyComponent {
    constructor(options) {
        this.options = options;
    }
    
    render() {
        return `<div class="my-component">${this.options.content}</div>`;
    }
}
```

### æ’ä»¶ç³»ç»Ÿï¼ˆæœªæ¥æ‰©å±•ï¼‰

```javascript
// æ’ä»¶æ¥å£è®¾è®¡
class Plugin {
    constructor(app) {
        this.app = app;
    }
    
    install() {
        // æ’ä»¶å®‰è£…é€»è¾‘
    }
    
    uninstall() {
        // æ’ä»¶å¸è½½é€»è¾‘
    }
}
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### å…³é”®æ€§èƒ½æŒ‡æ ‡

- **é¦–å±åŠ è½½æ—¶é—´**: < 1s
- **é¡µé¢åˆ‡æ¢æ—¶é—´**: < 200ms
- **å†…å­˜ä½¿ç”¨**: < 50MB
- **åŒ…å¤§å°**: ä¸»åŒ… < 500KB

### ä¼˜åŒ–ç­–ç•¥

1. **é¢„åŠ è½½**: åå°é¢„åŠ è½½éå½“å‰é¡µé¢
2. **ç¼“å­˜**: å¤šå±‚ç¼“å­˜å‡å°‘é‡å¤åŠ è½½
3. **å‹ç¼©**: Gzip/Brotliå‹ç¼©
4. **CDN**: é™æ€èµ„æºCDNåŠ é€Ÿ
5. **æ‡’åŠ è½½**: æŒ‰éœ€åŠ è½½æ¨¡å—å’Œèµ„æº

## ğŸ”’ å®‰å…¨è€ƒè™‘

### XSSé˜²æŠ¤

- æ‰€æœ‰ç”¨æˆ·è¾“å…¥éƒ½è¿›è¡Œè½¬ä¹‰
- ä½¿ç”¨ `textContent` è€Œé `innerHTML`
- CSP (Content Security Policy) é…ç½®

### æ•°æ®å®‰å…¨

- æ•æ„Ÿæ•°æ®ä¸å­˜å‚¨åœ¨å‰ç«¯
- APIè°ƒç”¨ä½¿ç”¨HTTPS
- æœ¬åœ°å­˜å‚¨æ•°æ®åŠ å¯†

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•

- æ ¸å¿ƒç±»å’Œæ–¹æ³•çš„å•å…ƒæµ‹è¯•
- å·¥å…·å‡½æ•°æµ‹è¯•
- ç»„ä»¶æ¸²æŸ“æµ‹è¯•

### é›†æˆæµ‹è¯•

- é¡µé¢å¯¼èˆªæµç¨‹æµ‹è¯•
- æ¨¡å—ç”Ÿå‘½å‘¨æœŸæµ‹è¯•
- å›½é™…åŒ–åŠŸèƒ½æµ‹è¯•

### E2Eæµ‹è¯•

- ç”¨æˆ·æ“ä½œæµç¨‹æµ‹è¯•
- è·¨æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
- æ€§èƒ½å›å½’æµ‹è¯•

é€šè¿‡è¿™ç§æ¶æ„è®¾è®¡ï¼ŒModuleWebUIå®ç°äº†é«˜åº¦çš„æ¨¡å—åŒ–ã€å¯æ‰©å±•æ€§å’Œæ€§èƒ½ä¼˜åŒ–ï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä¸€ä¸ªå¼ºå¤§è€Œçµæ´»çš„é¡µé¢ç®¡ç†ç³»ç»Ÿã€‚